# proc-mem-inject ä½¿ç”¨æ•™ç¨‹

## å‰ç½®æ¡ä»¶

1. æ‰‹æœºå·²åˆ·å…¥ **SKRoot Lite** è¡¥ä¸çš„å†…æ ¸
2. çŸ¥é“ä½ çš„ SKRoot **ROOT å¯†é’¥**
3. ç›®æ ‡è¿›ç¨‹æ˜¯ **64ä½** (ARM64)

## ç¬¬ä¸€æ­¥ï¼šè·å–ç¼–è¯‘å¥½çš„å·¥å…·

### æ–¹æ³•1ï¼šGitHub Actions è‡ªåŠ¨ç¼–è¯‘
1. æ‰“å¼€ https://github.com/l11223/proc-mem-inject
2. ç‚¹å‡» **Actions** æ ‡ç­¾
3. æ‰¾åˆ°æœ€æ–°çš„æˆåŠŸæ„å»ºï¼Œä¸‹è½½ **stealth-mem-arm64-v8a** äº§ç‰©

### æ–¹æ³•2ï¼šæœ¬åœ°ç¼–è¯‘
```bash
# è®¾ç½® NDK è·¯å¾„
export ANDROID_NDK_HOME=/path/to/ndk

# ç¼–è¯‘
cd proc-mem-inject
chmod +x build.sh
./build.sh

# äº§ç‰©åœ¨ outputs/arm64-v8a/stealth_mem
```

## ç¬¬äºŒæ­¥ï¼šæ¨é€åˆ°æ‰‹æœº

```bash
adb push outputs/arm64-v8a/stealth_mem /data/local/tmp/
adb shell chmod +x /data/local/tmp/stealth_mem
```

## ç¬¬ä¸‰æ­¥ï¼šåŸºæœ¬ä½¿ç”¨

### 1. è·å–ç›®æ ‡è¿›ç¨‹ PID

```bash
# ä¾‹å¦‚ç‹è€…è£è€€
adb shell pidof com.tencent.tmgp.sgame

# æˆ–è€…å…¶ä»–æ¸¸æˆ
adb shell pidof com.xxx.xxx
```

### 2. æŸ¥çœ‹å†…å­˜æ˜ å°„

```bash
adb shell /data/local/tmp/stealth_mem -k "ä½ çš„ROOTå¯†é’¥" -p è¿›ç¨‹PID --maps
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
Start              End                Perm  Name
--------------------------------------------------------------
0x0000007000000000 0x0000007000100000 r-x  /data/app/.../libil2cpp.so
0x0000007000100000 0x0000007000200000 r--  /data/app/.../libil2cpp.so
...
```

### 3. æŸ¥æ‰¾æ¨¡å—åŸºå€

```bash
# æŸ¥æ‰¾ libil2cpp.so (Unityæ¸¸æˆ)
adb shell /data/local/tmp/stealth_mem -k "å¯†é’¥" -p PID --find libil2cpp.so

# æŸ¥æ‰¾ libunity.so
adb shell /data/local/tmp/stealth_mem -k "å¯†é’¥" -p PID --find libunity.so

# æŸ¥æ‰¾ libUE4.so (è™šå¹»å¼•æ“æ¸¸æˆ)
adb shell /data/local/tmp/stealth_mem -k "å¯†é’¥" -p PID --find libUE4.so
```

### 4. è¯»å–å†…å­˜

```bash
# è¯»å–æŒ‡å®šåœ°å€çš„ 64 å­—èŠ‚
adb shell /data/local/tmp/stealth_mem -k "å¯†é’¥" -p PID --read 0x7000123456 -s 64
```

### 5. å†™å…¥å†…å­˜ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼ï¼‰

```bash
# å†™å…¥ NOP æŒ‡ä»¤ (ARM64 NOP = 1F2003D5)
adb shell /data/local/tmp/stealth_mem -k "å¯†é’¥" -p PID --write 0x7000123456 -d 1F2003D5

# å†™å…¥å¤šæ¡ NOPï¼ˆè·³è¿‡å‡½æ•°æ£€æµ‹ï¼‰
adb shell /data/local/tmp/stealth_mem -k "å¯†é’¥" -p PID --write 0x7000123456 -d 1F2003D51F2003D51F2003D51F2003D5

# å†™å…¥è¿”å›æŒ‡ä»¤ (RET = C0035FD6)
adb shell /data/local/tmp/stealth_mem -k "å¯†é’¥" -p PID --write 0x7000123456 -d C0035FD6

# å†™å…¥ MOV W0, #1; RET (è®©å‡½æ•°è¿”å›1)
adb shell /data/local/tmp/stealth_mem -k "å¯†é’¥" -p PID --write 0x7000123456 -d 200080D2C0035FD6

# å†™å…¥ MOV W0, #0; RET (è®©å‡½æ•°è¿”å›0)
adb shell /data/local/tmp/stealth_mem -k "å¯†é’¥" -p PID --write 0x7000123456 -d 000080D2C0035FD6
```

## å®æˆ˜ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šä¿®æ”¹æ¸¸æˆæ•°å€¼

```bash
# 1. è·å–æ¸¸æˆ PID
PID=$(adb shell pidof com.example.game)

# 2. æ‰¾åˆ° libil2cpp.so åŸºå€
adb shell /data/local/tmp/stealth_mem -k "key" -p $PID --find libil2cpp.so
# è¾“å‡º: libil2cpp.so åŸºå€: 0x7200000000

# 3. å‡è®¾ä½ ç”¨ IDA åˆ†æå‡ºç›®æ ‡å‡½æ•°åç§»æ˜¯ 0x123456
# è®¡ç®—å®é™…åœ°å€ = åŸºå€ + åç§» = 0x7200000000 + 0x123456 = 0x7200123456

# 4. è¯»å–åŸå§‹æŒ‡ä»¤ï¼ˆå¤‡ä»½ï¼‰
adb shell /data/local/tmp/stealth_mem -k "key" -p $PID --read 0x7200123456 -s 16

# 5. å†™å…¥ä¿®æ”¹
# ä¾‹å¦‚è®© GetDamage() è¿”å› 999
# MOV W0, #999 = E0CF87D2
# RET = C0035FD6
adb shell /data/local/tmp/stealth_mem -k "key" -p $PID --write 0x7200123456 -d E0CF87D2C0035FD6
```

### ç¤ºä¾‹2ï¼šç»•è¿‡æ£€æµ‹å‡½æ•°

```bash
# å‡è®¾ IsCheatDetected() åœ¨åç§» 0xABCDEF
# è®©å®ƒç›´æ¥è¿”å› 0 (false)

# MOV W0, #0; RET
adb shell /data/local/tmp/stealth_mem -k "key" -p $PID --write 0x7200ABCDEF -d 000080D2C0035FD6
```

## å¸¸ç”¨ ARM64 æŒ‡ä»¤ (åå…­è¿›åˆ¶)

| æŒ‡ä»¤ | åå…­è¿›åˆ¶ | è¯´æ˜ |
|------|----------|------|
| NOP | 1F2003D5 | ç©ºæ“ä½œ |
| RET | C0035FD6 | è¿”å› |
| MOV W0, #0 | 000080D2 | W0 = 0 |
| MOV W0, #1 | 200080D2 | W0 = 1 |
| MOV W0, #999 | E0CF87D2 | W0 = 999 |
| MOV X0, #0 | 000080D2 | X0 = 0 |
| B (è·³è½¬) | éœ€è®¡ç®— | ç›¸å¯¹è·³è½¬ |

## æ³¨æ„äº‹é¡¹

1. **è¿›ç¨‹é‡å¯åä¿®æ”¹å¤±æ•ˆ** - è¿™æ˜¯ç‰¹æ€§ä¸æ˜¯bugï¼Œä¿è¯æ— ç—•
2. **éœ€è¦æ¯æ¬¡æ¸¸æˆå¯åŠ¨åé‡æ–°æ³¨å…¥**
3. **åœ°å€ä¼šå˜åŒ–** - æ¯æ¬¡å¯åŠ¨åŸºå€å¯èƒ½ä¸åŒï¼Œéœ€è¦é‡æ–°è®¡ç®—
4. **ä»…æ”¯æŒ ARM64** - 32ä½è¿›ç¨‹ä¸æ”¯æŒ
5. **éœ€è¦ SKRoot Lite å†…æ ¸** - æ™®é€š ROOT å¯èƒ½æ— æ³•å†™å…¥ /proc/pid/mem

## ä¸å…¶ä»–å·¥å…·é…åˆ

1. **IDA Pro** - åˆ†æ SO æ–‡ä»¶ï¼Œæ‰¾åˆ°ç›®æ ‡å‡½æ•°åç§»
2. **Frida** - åŠ¨æ€åˆ†æï¼Œç¡®å®šè¦ä¿®æ”¹çš„ä½ç½®
3. **GameGuardian** - æœç´¢æ•°å€¼ï¼Œæ‰¾åˆ°å†…å­˜åœ°å€
4. **CE (Cheat Engine)** - é…åˆ ceserver æœç´¢

## ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•æ›´éšè”½ï¼Ÿ

| æ–¹æ³• | ä¿®æ”¹æ–‡ä»¶ | ä½¿ç”¨ptrace | æ£€æµ‹éš¾åº¦ |
|------|----------|------------|----------|
| ä¼ ç»ŸSOæ³¨å…¥ | âœ… æ˜¯ | âœ… æ˜¯ | å®¹æ˜“ |
| Frida | âŒ å¦ | âœ… æ˜¯ | ä¸­ç­‰ |
| **proc-mem-inject** | âŒ å¦ | âŒ å¦ | å›°éš¾ |

æˆ‘ä»¬ç›´æ¥é€šè¿‡ `/proc/pid/mem` è¯»å†™å†…å­˜ï¼Œä¸ç•™ä¸‹ä»»ä½•æ–‡ä»¶ç—•è¿¹ï¼Œä¹Ÿä¸è§¦å‘ ptrace æ£€æµ‹ã€‚

## é—®é¢˜æ’æŸ¥

### é”™è¯¯: ERR_NO_ROOT
- æ£€æŸ¥ ROOT å¯†é’¥æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æ‰‹æœºå·²åˆ·å…¥ SKRoot Lite å†…æ ¸

### é”™è¯¯: ERR_OPEN_MEM
- ç›®æ ‡è¿›ç¨‹å¯èƒ½å·²é€€å‡º
- æ£€æŸ¥ PID æ˜¯å¦æ­£ç¡®

### é”™è¯¯: ERR_WRITE_MEM
- ç›®æ ‡åœ°å€å¯èƒ½ä¸å¯å†™
- æŸäº›å†…å­˜åŒºåŸŸæœ‰ä¿æŠ¤

---

ç¥ä½ ç©å¾—å¼€å¿ƒï¼æœ‰é—®é¢˜éšæ—¶é—®æˆ‘~ ğŸ’•
