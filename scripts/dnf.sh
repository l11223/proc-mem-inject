#!/system/bin/sh
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘                     StealthMem Pro v5.0 - ç»ˆæç‰ˆ                          â•‘
# â•‘  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•‘
# â•‘  ç‰¹æ€§: åæ£€æµ‹ | æ‰¹é‡Patch | å®æ—¶ç›‘æ§ | å¤šæ¸¸æˆ | æ•°å€¼æœç´¢ | å†å²è®°å½•       â•‘
# â•‘  ä½œè€…: SKRoot Team | åŸºäº /proc/pid/mem å†…æ ¸çº§å†…å­˜è®¿é—®                    â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

VERSION="5.0"
BUILD_DATE="2025.01"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 æ ¸å¿ƒé…ç½®
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ROOT_KEY="GD5IyCe0opOqirn6Qs1qDNVFWqpmYc3cNAd9pOgJ8erzOpMf"
TOOL="/data/local/tmp/stealth_mem"
SU="/data/GD5IyCe0opOqirn6/su"
PATCH_DIR="/data/local/tmp/patches"
LOG_FILE="/data/local/tmp/stealth.log"
HISTORY_FILE="/data/local/tmp/stealth_history.txt"
FAVORITES_FILE="/data/local/tmp/stealth_favorites.txt"

# è¿è¡Œæ—¶çŠ¶æ€
GAME_PKG="com.tencent.tmgp.dnf"
GAME_NAME="DNF"
PID=""
STEALTH_MODE="--stealth"
STEALTH_ON=1
LAST_ADDR=""
LAST_VALUE=""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 é¢œè‰²å®šä¹‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
R='\033[1;31m'    # çº¢è‰² - é”™è¯¯
G='\033[1;32m'    # ç»¿è‰² - æˆåŠŸ
Y='\033[1;33m'    # é»„è‰² - è­¦å‘Š
B='\033[1;34m'    # è“è‰² - ä¿¡æ¯
P='\033[1;35m'    # ç´«è‰² - ç‰¹æ®Š
C='\033[1;36m'    # é’è‰² - æ ‡é¢˜
W='\033[1;37m'    # ç™½è‰² - æ™®é€š
D='\033[0;90m'    # ç°è‰² - æ¬¡è¦
N='\033[0m'       # é‡ç½®

# èƒŒæ™¯è‰²
BG_R='\033[41m'   # çº¢åº•
BG_G='\033[42m'   # ç»¿åº•
BG_B='\033[44m'   # è“åº•
BG_Y='\033[43m'   # é»„åº•

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 å·¥å…·å‡½æ•°
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æ—¥å¿—è®°å½•
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1" >> "$LOG_FILE"
}

# å†å²è®°å½•
add_history() {
    echo "[$(date '+%H:%M:%S')] $1" >> "$HISTORY_FILE"
    # ä¿ç•™æœ€è¿‘100æ¡
    tail -100 "$HISTORY_FILE" > "$HISTORY_FILE.tmp" 2>/dev/null
    mv "$HISTORY_FILE.tmp" "$HISTORY_FILE" 2>/dev/null
}

# è¾“å‡ºå‡½æ•°
p_ok()      { printf "  ${G}âœ“${N} %s\n" "$1"; }
p_err()     { printf "  ${R}âœ—${N} %s\n" "$1"; }
p_warn()    { printf "  ${Y}!${N} %s\n" "$1"; }
p_info()    { printf "  ${B}*${N} %s\n" "$1"; }
p_special() { printf "  ${P}â˜…${N} %s\n" "$1"; }

# æ¸…å±
cls() { clear 2>/dev/null || printf "\033[2J\033[H"; }

# æš‚åœ
pause() {
    printf "\n  ${D}æŒ‰å›è½¦ç»§ç»­...${N}"
    read _
}

# ç»˜åˆ¶è¾¹æ¡†
draw_box() {
    local title="$1"
    local width=60
    printf "${C}â•”"
    printf 'â•%.0s' $(seq 1 $width)
    printf "â•—${N}\n"
    printf "${C}â•‘${N}${W}  %-$((width-2))s${N}${C}â•‘${N}\n" "$title"
    printf "${C}â• "
    printf 'â•%.0s' $(seq 1 $width)
    printf "â•£${N}\n"
}

draw_box_end() {
    local width=60
    printf "${C}â•š"
    printf 'â•%.0s' $(seq 1 $width)
    printf "â•${N}\n"
}

# èœå•é¡¹
menu_item() {
    local num="$1"
    local text="$2"
    local extra="$3"
    if [ -n "$extra" ]; then
        printf "${C}â•‘${N}  ${Y}%s${N}. %-40s ${D}%s${N}${C}â•‘${N}\n" "$num" "$text" "$extra"
    else
        printf "${C}â•‘${N}  ${Y}%s${N}. %-52s${C}â•‘${N}\n" "$num" "$text"
    fi
}

menu_separator() {
    printf "${C}â•‘${N}  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}${C}â•‘${N}\n"
}

menu_empty() {
    printf "${C}â•‘${N}  %-56s${C}â•‘${N}\n" " "
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 ç¯å¢ƒæ£€æŸ¥
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

init() {
    mkdir -p "$PATCH_DIR" 2>/dev/null
    touch "$HISTORY_FILE" 2>/dev/null
    touch "$FAVORITES_FILE" 2>/dev/null
    
    if [ ! -f "$TOOL" ]; then
        cls
        printf "\n${R}"
        cat << 'ERREOF'
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘                    âš  é”™è¯¯                             â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
  â•‘  æ‰¾ä¸åˆ° stealth_mem å·¥å…·                              â•‘
  â•‘                                                       â•‘
  â•‘  è¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:                                      â•‘
  â•‘  adb push stealth_mem /data/local/tmp/                â•‘
  â•‘  chmod +x /data/local/tmp/stealth_mem                 â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ERREOF
        printf "${N}\n"
        exit 1
    fi
    
    if [ ! -f "$SU" ]; then
        cls
        printf "\n${R}"
        cat << 'ERREOF'
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘                    âš  é”™è¯¯                             â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
  â•‘  æ‰¾ä¸åˆ° SKRoot su                                     â•‘
  â•‘                                                       â•‘
  â•‘  è¯·ç¡®ä¿å·²å®‰è£… SKRoot Lite å†…æ ¸                        â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ERREOF
        printf "${N}\n"
        exit 1
    fi
    
    chmod +x "$TOOL" 2>/dev/null
    log "=== StealthMem Pro v$VERSION å¯åŠ¨ ==="
}

# è·å–PID
refresh_pid() {
    PID=$($SU -c "pidof $GAME_PKG" 2>/dev/null | awk '{print $1}')
}

# æ£€æŸ¥æ¸¸æˆçŠ¶æ€
check_game() {
    refresh_pid
    [ -n "$PID" ]
}

# æ‰§è¡Œå·¥å…·å‘½ä»¤
run() {
    $TOOL -k "$ROOT_KEY" -p "$PID" $STEALTH_MODE "$@"
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 ä¸»æ¨ªå¹…
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

banner() {
    cls
    printf "${P}"
    cat << 'BANNER'

   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—
   â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
   â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘
   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
   â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•   â•šâ•â•  â•šâ•â•
BANNER
    printf "${N}"
    printf "${C}   â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—${N}\n"
    printf "${C}   â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘${N}  ${D}Pro Edition${N}\n"
    printf "${C}   â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘${N}  ${Y}v$VERSION${N} ${D}($BUILD_DATE)${N}\n"
    printf "${C}   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘${N}\n"
    printf "${C}   â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘${N}  ${D}Kernel-Level Memory Tool${N}\n"
    printf "${C}   â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•${N}\n"
    printf "\n"
    show_status_bar
}

# çŠ¶æ€æ 
show_status_bar() {
    local game_status pid_status stealth_status
    
    if check_game; then
        game_status="${BG_G}${W} è¿è¡Œä¸­ ${N}"
        pid_status="${G}$PID${N}"
    else
        game_status="${BG_R}${W} æœªè¿è¡Œ ${N}"
        pid_status="${D}---${N}"
    fi
    
    if [ $STEALTH_ON -eq 1 ]; then
        stealth_status="${G}â— ON${N}"
    else
        stealth_status="${R}â—‹ OFF${N}"
    fi
    
    printf "  ${D}â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”${N}\n"
    printf "  ${D}â”‚${N} ${W}æ¸¸æˆ:${N} %-10s %b  ${W}PID:${N} %-10b  ${W}åæ£€æµ‹:${N} %b ${D}â”‚${N}\n" "$GAME_NAME" "$game_status" "$pid_status" "$stealth_status"
    printf "  ${D}â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜${N}\n"
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 æ¸¸æˆé€‰æ‹©
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

select_game() {
    cls
    printf "\n"
    draw_box "é€‰æ‹©ç›®æ ‡æ¸¸æˆ"
    menu_item "1" "DNF åœ°ä¸‹åŸä¸å‹‡å£«" "è…¾è®¯"
    menu_item "2" "ç‹è€…è£è€€" "è…¾è®¯"
    menu_item "3" "å’Œå¹³ç²¾è‹± / PUBG" "è…¾è®¯"
    menu_item "4" "è‹±é›„è”ç›Ÿæ‰‹æ¸¸" "è…¾è®¯"
    menu_item "5" "åŸç¥" "ç±³å“ˆæ¸¸"
    menu_item "6" "å´©åï¼šæ˜Ÿç©¹é“é“" "ç±³å“ˆæ¸¸"
    menu_item "7" "æ˜æ—¥æ–¹èˆŸ" "é¹°è§’"
    menu_separator
    menu_item "8" "è‡ªå®šä¹‰åŒ…å" ""
    menu_item "9" "ä»è¿è¡Œä¸­é€‰æ‹©" ""
    menu_empty
    menu_item "0" "è¿”å›ä¸»èœå•" ""
    draw_box_end
    
    printf "\n  ${W}é€‰æ‹© > ${N}"
    read choice
    
    case "$choice" in
        1) GAME_PKG="com.tencent.tmgp.dnf"; GAME_NAME="DNF" ;;
        2) GAME_PKG="com.tencent.tmgp.sgame"; GAME_NAME="ç‹è€…è£è€€" ;;
        3) GAME_PKG="com.tencent.tmgp.pubgmhd"; GAME_NAME="å’Œå¹³ç²¾è‹±" ;;
        4) GAME_PKG="com.tencent.lolm"; GAME_NAME="LOLæ‰‹æ¸¸" ;;
        5) GAME_PKG="com.miHoYo.Yuanshen"; GAME_NAME="åŸç¥" ;;
        6) GAME_PKG="com.miHoYo.hkrpg"; GAME_NAME="æ˜Ÿç©¹é“é“" ;;
        7) GAME_PKG="com.hypergryph.arknights"; GAME_NAME="æ˜æ—¥æ–¹èˆŸ" ;;
        8)
            printf "\n  ${W}è¾“å…¥åŒ…å: ${N}"
            read pkg
            if [ -n "$pkg" ]; then
                GAME_PKG="$pkg"
                GAME_NAME="$pkg"
            fi
            ;;
        9) select_from_running ;;
        0) return ;;
        *) return ;;
    esac
    
    if [ "$choice" != "0" ] && [ "$choice" != "9" ]; then
        p_ok "å·²é€‰æ‹©: $GAME_NAME"
        log "åˆ‡æ¢æ¸¸æˆ: $GAME_NAME ($GAME_PKG)"
        add_history "é€‰æ‹©æ¸¸æˆ: $GAME_NAME"
        sleep 1
    fi
}

# ä»è¿è¡Œä¸­çš„è¿›ç¨‹é€‰æ‹©
select_from_running() {
    printf "\n"
    p_info "æ‰«æè¿è¡Œä¸­çš„æ¸¸æˆè¿›ç¨‹..."
    echo ""
    
    local count=0
    local pids=""
    local names=""
    
    # å¸¸è§æ¸¸æˆåŒ…ååˆ—è¡¨
    for pkg in com.tencent.tmgp.dnf com.tencent.tmgp.sgame com.tencent.tmgp.pubgmhd \
               com.tencent.lolm com.miHoYo.Yuanshen com.miHoYo.hkrpg \
               com.hypergryph.arknights com.netease.onmyoji; do
        local p=$($SU -c "pidof $pkg" 2>/dev/null | awk '{print $1}')
        if [ -n "$p" ]; then
            count=$((count + 1))
            printf "  ${Y}%d${N}. %s ${G}(PID: %s)${N}\n" "$count" "$pkg" "$p"
            eval "pkg_$count=$pkg"
            eval "pid_$count=$p"
        fi
    done
    
    if [ $count -eq 0 ]; then
        p_warn "æœªå‘ç°è¿è¡Œä¸­çš„æ¸¸æˆ"
        pause
        return
    fi
    
    printf "\n  ${W}é€‰æ‹© (1-%d): ${N}" "$count"
    read sel
    
    if [ "$sel" -ge 1 ] 2>/dev/null && [ "$sel" -le "$count" ] 2>/dev/null; then
        eval "GAME_PKG=\$pkg_$sel"
        GAME_NAME="$GAME_PKG"
        p_ok "å·²é€‰æ‹©: $GAME_NAME"
        sleep 1
    fi
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 å†…å­˜æ“ä½œ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

mem_read() {
    if ! check_game; then
        p_err "æ¸¸æˆæœªè¿è¡Œï¼Œè¯·å…ˆå¯åŠ¨æ¸¸æˆ"
        pause
        return
    fi
    
    printf "\n  ${W}åœ°å€ (0x...): ${N}"
    read addr
    [ -z "$addr" ] && return
    
    printf "  ${W}å¤§å° [64]: ${N}"
    read size
    [ -z "$size" ] && size=64
    
    printf "\n"
    p_info "è¯»å–å†…å­˜: $addr ($size bytes)"
    printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
    run --read "$addr" -s "$size"
    printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
    
    LAST_ADDR="$addr"
    log "è¯»å–å†…å­˜: $addr ($size bytes)"
    add_history "è¯»å–: $addr"
    pause
}

mem_write() {
    if ! check_game; then
        p_err "æ¸¸æˆæœªè¿è¡Œï¼Œè¯·å…ˆå¯åŠ¨æ¸¸æˆ"
        pause
        return
    fi
    
    printf "\n  ${W}åœ°å€ (0x...): ${N}"
    read addr
    [ -z "$addr" ] && return
    
    printf "  ${W}æ•°æ®ç±»å‹:${N}\n"
    printf "    ${Y}1${N}. Hex å­—èŠ‚ (å¦‚: 00 00 80 3F)\n"
    printf "    ${Y}2${N}. Int32 æ•´æ•°\n"
    printf "    ${Y}3${N}. Float æµ®ç‚¹\n"
    printf "  ${W}é€‰æ‹© [1]: ${N}"
    read dtype
    [ -z "$dtype" ] && dtype=1
    
    case "$dtype" in
        1)
            printf "  ${W}Hexæ•°æ®: ${N}"
            read data
            ;;
        2)
            printf "  ${W}æ•´æ•°å€¼: ${N}"
            read val
            # è½¬æ¢ä¸ºå°ç«¯hex
            data=$(printf '%08X' "$val" | sed 's/\(..\)\(..\)\(..\)\(..\)/\4 \3 \2 \1/')
            ;;
        3)
            printf "  ${W}æµ®ç‚¹å€¼: ${N}"
            read val
            # ç®€å•å¤„ç†ï¼Œå®é™…éœ€è¦æ›´å¤æ‚çš„è½¬æ¢
            p_warn "æµ®ç‚¹è½¬æ¢éœ€è¦å·¥å…·æ”¯æŒ"
            pause
            return
            ;;
    esac
    
    if [ -n "$addr" ] && [ -n "$data" ]; then
        printf "\n"
        p_info "å†™å…¥: $addr = $data"
        run --write "$addr" -d "$data"
        
        LAST_ADDR="$addr"
        LAST_VALUE="$data"
        log "å†™å…¥å†…å­˜: $addr = $data"
        add_history "å†™å…¥: $addr = $data"
    fi
    pause
}

mem_maps() {
    if ! check_game; then
        p_err "æ¸¸æˆæœªè¿è¡Œ"
        pause
        return
    fi
    
    printf "\n"
    p_info "è·å–å†…å­˜æ˜ å°„ (å‰50æ¡)..."
    printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
    run --maps | head -50
    printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
    p_warn "å®Œæ•´æ˜ å°„è¯·ä½¿ç”¨å¯¼å‡ºåŠŸèƒ½"
    pause
}

find_module() {
    if ! check_game; then
        p_err "æ¸¸æˆæœªè¿è¡Œ"
        pause
        return
    fi
    
    cls
    printf "\n"
    draw_box "æŸ¥æ‰¾æ¨¡å—"
    menu_item "1" "libil2cpp.so" "Unityå¼•æ“"
    menu_item "2" "libUE4.so" "è™šå¹»å¼•æ“"
    menu_item "3" "libtersafe.so" "è…¾è®¯å®‰å…¨"
    menu_item "4" "libGameCore.so" "æ¸¸æˆæ ¸å¿ƒ"
    menu_item "5" "libmain.so" "ä¸»æ¨¡å—"
    menu_item "6" "libc.so" "Cåº“"
    menu_separator
    menu_item "7" "è‡ªå®šä¹‰æ¨¡å—å" ""
    menu_item "8" "åˆ—å‡ºæ‰€æœ‰SO" ""
    menu_empty
    menu_item "0" "è¿”å›" ""
    draw_box_end
    
    printf "\n  ${W}é€‰æ‹© > ${N}"
    read choice
    
    local module=""
    case "$choice" in
        1) module="libil2cpp.so" ;;
        2) module="libUE4.so" ;;
        3) module="libtersafe.so" ;;
        4) module="libGameCore.so" ;;
        5) module="libmain.so" ;;
        6) module="libc.so" ;;
        7) printf "  ${W}æ¨¡å—å: ${N}"; read module ;;
        8)
            printf "\n"
            p_info "åˆ—å‡ºæ‰€æœ‰åŠ è½½çš„SOæ¨¡å—..."
            printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
            run --maps | grep "\.so" | awk '{print $NF}' | sort -u
            printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
            pause
            return
            ;;
        0) return ;;
    esac
    
    if [ -n "$module" ]; then
        printf "\n"
        p_info "æŸ¥æ‰¾æ¨¡å—: $module"
        printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
        run --find "$module"
        printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
        log "æŸ¥æ‰¾æ¨¡å—: $module"
        add_history "æŸ¥æ‰¾: $module"
        pause
    fi
}

mem_menu() {
    while true; do
        banner
        draw_box "å†…å­˜æ“ä½œ"
        menu_item "1" "è¯»å–å†…å­˜" "Read"
        menu_item "2" "å†™å…¥å†…å­˜" "Write"
        menu_item "3" "å†…å­˜æ˜ å°„" "Maps"
        menu_item "4" "æŸ¥æ‰¾æ¨¡å—" "Find"
        menu_separator
        menu_item "5" "é‡å¤ä¸Šæ¬¡æ“ä½œ" "Last: $LAST_ADDR"
        menu_item "6" "æ”¶è—å¤¹" ""
        menu_empty
        menu_item "0" "è¿”å›ä¸»èœå•" ""
        draw_box_end
        
        printf "\n  ${W}é€‰æ‹© > ${N}"
        read choice
        
        case "$choice" in
            1) mem_read ;;
            2) mem_write ;;
            3) mem_maps ;;
            4) find_module ;;
            5)
                if [ -n "$LAST_ADDR" ]; then
                    p_info "é‡å¤è¯»å–: $LAST_ADDR"
                    run --read "$LAST_ADDR" -s 64
                    pause
                else
                    p_warn "æ²¡æœ‰ä¸Šæ¬¡æ“ä½œè®°å½•"
                    pause
                fi
                ;;
            6) favorites_menu ;;
            0) return ;;
        esac
    done
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 Patch æ“ä½œ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

list_patches() {
    printf "\n  ${W}å¯ç”¨é…ç½®æ–‡ä»¶:${N}\n"
    local count=0
    for f in "$PATCH_DIR"/*.patch 2>/dev/null; do
        [ -f "$f" ] || continue
        count=$((count + 1))
        local name=$(basename "$f")
        local lines=$(wc -l < "$f" 2>/dev/null)
        printf "    ${Y}%d${N}. %-30s ${D}(%dè¡Œ)${N}\n" "$count" "$name" "$lines"
    done
    [ $count -eq 0 ] && printf "    ${D}(æ— é…ç½®æ–‡ä»¶)${N}\n"
}

apply_patch() {
    if ! check_game; then
        p_err "æ¸¸æˆæœªè¿è¡Œ"
        pause
        return
    fi
    
    list_patches
    printf "\n  ${W}é…ç½®æ–‡ä»¶å: ${N}"
    read pfile
    [ -z "$pfile" ] && return
    
    local path="$PATCH_DIR/$pfile"
    [ ! -f "$path" ] && path="$pfile"
    
    if [ -f "$path" ]; then
        printf "\n"
        p_info "åº”ç”¨ Patch: $(basename "$path")"
        printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
        run --batch "$path"
        printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
        log "åº”ç”¨Patch: $path"
        add_history "Patch: $(basename "$path")"
    else
        p_err "æ–‡ä»¶ä¸å­˜åœ¨: $path"
    fi
    pause
}

monitor_patch() {
    if ! check_game; then
        p_err "æ¸¸æˆæœªè¿è¡Œ"
        pause
        return
    fi
    
    list_patches
    printf "\n  ${W}é…ç½®æ–‡ä»¶å: ${N}"
    read pfile
    [ -z "$pfile" ] && return
    
    local path="$PATCH_DIR/$pfile"
    [ ! -f "$path" ] && path="$pfile"
    
    if [ -f "$path" ]; then
        printf "\n"
        printf "  ${BG_Y}${W} ç›‘æ§æ¨¡å¼ ${N}\n"
        p_info "é…ç½®: $(basename "$path")"
        p_warn "æŒ‰ Ctrl+C é€€å‡ºç›‘æ§"
        printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
        run --monitor "$path"
        printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
        log "ç›‘æ§æ¨¡å¼: $path"
    else
        p_err "æ–‡ä»¶ä¸å­˜åœ¨: $path"
    fi
    pause
}

create_patch() {
    printf "\n  ${W}æ–‡ä»¶å (å¦‚ my.patch): ${N}"
    read fname
    [ -z "$fname" ] && return
    
    local path="$PATCH_DIR/$fname"
    
    cat > "$path" << 'PATCHEOF'
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘                         Patch é…ç½®æ–‡ä»¶                                    â•‘
# â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
# â•‘  æ ¼å¼:                                                                    â•‘
# â•‘    [åç§°]                                                                 â•‘
# â•‘    module=æ¨¡å—å                                                          â•‘
# â•‘    offset=åç§»åœ°å€                                                        â•‘
# â•‘    original=åŸå§‹å­—èŠ‚ (å¯é€‰,ç”¨äºéªŒè¯)                                      â•‘
# â•‘    patch=ä¿®æ”¹å­—èŠ‚                                                         â•‘
# â•‘    enabled=true/false                                                     â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ç¤ºä¾‹: è®©æ£€æµ‹å‡½æ•°è¿”å›0
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# [ç»•è¿‡æ£€æµ‹]
# module=libtersafe.so
# offset=0x123456
# original=FF 43 01 D1
# patch=00 00 80 D2 C0 03 5F D6
# enabled=true

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ARM64 å¸¸ç”¨æŒ‡ä»¤å‚è€ƒ:
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#   è¿”å›0: 00 00 80 D2 C0 03 5F D6  (MOV X0,#0; RET)
#   è¿”å›1: 20 00 80 D2 C0 03 5F D6  (MOV X0,#1; RET)
#   NOP:   1F 20 03 D5
#   RET:   C0 03 5F D6
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PATCHEOF

    p_ok "å·²åˆ›å»º: $path"
    log "åˆ›å»ºé…ç½®: $path"
    add_history "åˆ›å»º: $fname"
    pause
}

patch_menu() {
    while true; do
        banner
        draw_box "Patch æ“ä½œ"
        menu_item "1" "åº”ç”¨ Patch" "ä¸€æ¬¡æ€§"
        menu_item "2" "ç›‘æ§æ¨¡å¼" "è‡ªåŠ¨é‡å†™"
        menu_item "3" "æŸ¥çœ‹é…ç½®" ""
        menu_separator
        menu_item "4" "åˆ›å»ºé…ç½®" "æ–°å»º"
        menu_item "5" "ç¼–è¾‘é…ç½®" ""
        menu_item "6" "åˆ é™¤é…ç½®" ""
        menu_empty
        menu_item "0" "è¿”å›ä¸»èœå•" ""
        draw_box_end
        
        printf "\n  ${W}é€‰æ‹© > ${N}"
        read choice
        
        case "$choice" in
            1) apply_patch ;;
            2) monitor_patch ;;
            3)
                list_patches
                printf "\n  ${W}æŸ¥çœ‹æ–‡ä»¶: ${N}"
                read f
                [ -z "$f" ] && continue
                local p="$PATCH_DIR/$f"
                [ ! -f "$p" ] && p="$f"
                if [ -f "$p" ]; then
                    printf "\n  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                    cat "$p"
                    printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                fi
                pause
                ;;
            4) create_patch ;;
            5)
                list_patches
                printf "\n  ${W}ç¼–è¾‘æ–‡ä»¶: ${N}"
                read f
                [ -z "$f" ] && continue
                local p="$PATCH_DIR/$f"
                [ -f "$p" ] && vi "$p" 2>/dev/null || nano "$p" 2>/dev/null
                ;;
            6)
                list_patches
                printf "\n  ${W}åˆ é™¤æ–‡ä»¶: ${N}"
                read f
                [ -z "$f" ] && continue
                local p="$PATCH_DIR/$f"
                if [ -f "$p" ]; then
                    rm -f "$p"
                    p_ok "å·²åˆ é™¤: $f"
                    sleep 1
                fi
                ;;
            0) return ;;
        esac
    done
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 æ”¶è—å¤¹
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

add_favorite() {
    printf "\n  ${W}åç§°: ${N}"
    read name
    printf "  ${W}åœ°å€: ${N}"
    read addr
    printf "  ${W}å¤‡æ³¨: ${N}"
    read note
    
    if [ -n "$name" ] && [ -n "$addr" ]; then
        echo "$name|$addr|$note" >> "$FAVORITES_FILE"
        p_ok "å·²æ·»åŠ åˆ°æ”¶è—å¤¹"
    fi
}

favorites_menu() {
    while true; do
        cls
        printf "\n"
        draw_box "æ”¶è—å¤¹"
        
        local count=0
        while IFS='|' read -r name addr note; do
            [ -z "$name" ] && continue
            count=$((count + 1))
            printf "${C}â•‘${N}  ${Y}%d${N}. %-20s ${G}%s${N} ${D}%s${N}\n" "$count" "$name" "$addr" "$note"
        done < "$FAVORITES_FILE" 2>/dev/null
        
        [ $count -eq 0 ] && printf "${C}â•‘${N}  ${D}(æ”¶è—å¤¹ä¸ºç©º)${N}\n"
        
        menu_separator
        menu_item "a" "æ·»åŠ æ”¶è—" ""
        menu_item "d" "åˆ é™¤æ”¶è—" ""
        menu_item "r" "è¯»å–é€‰ä¸­" ""
        menu_empty
        menu_item "0" "è¿”å›" ""
        draw_box_end
        
        printf "\n  ${W}é€‰æ‹© > ${N}"
        read choice
        
        case "$choice" in
            a) add_favorite ;;
            d)
                printf "  ${W}åˆ é™¤ç¬¬å‡ ä¸ª: ${N}"
                read num
                if [ -n "$num" ]; then
                    sed -i "${num}d" "$FAVORITES_FILE" 2>/dev/null
                    p_ok "å·²åˆ é™¤"
                    sleep 1
                fi
                ;;
            r)
                printf "  ${W}è¯»å–ç¬¬å‡ ä¸ª: ${N}"
                read num
                if [ -n "$num" ] && check_game; then
                    local addr=$(sed -n "${num}p" "$FAVORITES_FILE" 2>/dev/null | cut -d'|' -f2)
                    if [ -n "$addr" ]; then
                        run --read "$addr" -s 64
                        pause
                    fi
                fi
                ;;
            0) return ;;
        esac
    done
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 å¿«æ·åŠŸèƒ½
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

quick_tersafe() {
    if ! check_game; then
        p_err "æ¸¸æˆæœªè¿è¡Œ"
        pause
        return
    fi
    
    printf "\n"
    printf "  ${BG_B}${W} è…¾è®¯å®‰å…¨åˆ†æ ${N}\n\n"
    p_info "æŸ¥æ‰¾ libtersafe.so..."
    
    local result=$(run --find libtersafe.so 2>&1)
    echo "$result"
    
    local base=$(echo "$result" | grep -i "åŸºå€\|base" | head -1)
    
    if [ -n "$base" ]; then
        printf "\n"
        p_ok "æ‰¾åˆ°è…¾è®¯å®‰å…¨æ¨¡å—"
        printf "\n  ${Y}æç¤º:${N}\n"
        printf "    1. ä½¿ç”¨ IDA åˆ†æ libtersafe.so\n"
        printf "    2. æ‰¾åˆ°æ£€æµ‹å‡½æ•°çš„åç§»åœ°å€\n"
        printf "    3. åˆ›å»º Patch é…ç½®æ–‡ä»¶\n"
        printf "    4. ä½¿ç”¨ç›‘æ§æ¨¡å¼ä¿æŒä¿®æ”¹\n"
    else
        p_warn "æœªæ‰¾åˆ° libtersafe.so (å¯èƒ½æ¸¸æˆæœªä½¿ç”¨æˆ–å·²æ”¹å)"
    fi
    pause
}

export_maps() {
    if ! check_game; then
        p_err "æ¸¸æˆæœªè¿è¡Œ"
        pause
        return
    fi
    
    local timestamp=$(date '+%Y%m%d_%H%M%S')
    local out="/data/local/tmp/maps_${GAME_NAME}_${timestamp}.txt"
    
    p_info "å¯¼å‡ºå†…å­˜æ˜ å°„..."
    run --maps > "$out"
    
    local lines=$(wc -l < "$out")
    p_ok "å·²å¯¼å‡º: $out"
    p_info "å…± $lines æ¡è®°å½•"
    log "å¯¼å‡ºæ˜ å°„: $out"
    add_history "å¯¼å‡º: $out"
    pause
}

quick_menu() {
    while true; do
        banner
        draw_box "å¿«æ·åŠŸèƒ½"
        menu_item "1" "è…¾è®¯å®‰å…¨åˆ†æ" "libtersafe"
        menu_item "2" "å¯¼å‡ºå†…å­˜æ˜ å°„" "ä¿å­˜åˆ°æ–‡ä»¶"
        menu_item "3" "åˆ·æ–°æ¸¸æˆçŠ¶æ€" ""
        menu_separator
        menu_item "4" "æŸ¥çœ‹æ“ä½œå†å²" ""
        menu_item "5" "æŸ¥çœ‹æ—¥å¿—" ""
        menu_item "6" "ç³»ç»Ÿä¿¡æ¯" ""
        menu_empty
        menu_item "0" "è¿”å›ä¸»èœå•" ""
        draw_box_end
        
        printf "\n  ${W}é€‰æ‹© > ${N}"
        read choice
        
        case "$choice" in
            1) quick_tersafe ;;
            2) export_maps ;;
            3)
                refresh_pid
                if [ -n "$PID" ]; then
                    p_ok "æ¸¸æˆè¿è¡Œä¸­ - PID: $PID"
                else
                    p_warn "æ¸¸æˆæœªè¿è¡Œ"
                fi
                sleep 1
                ;;
            4)
                printf "\n  ${W}æœ€è¿‘æ“ä½œ:${N}\n"
                printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                tail -20 "$HISTORY_FILE" 2>/dev/null || echo "  (æ— è®°å½•)"
                printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                pause
                ;;
            5)
                printf "\n  ${W}ç³»ç»Ÿæ—¥å¿—:${N}\n"
                printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                tail -30 "$LOG_FILE" 2>/dev/null || echo "  (æ— æ—¥å¿—)"
                printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                pause
                ;;
            6)
                printf "\n"
                printf "  ${W}ç³»ç»Ÿä¿¡æ¯:${N}\n"
                printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                printf "  å†…æ ¸: $(uname -r 2>/dev/null || echo 'N/A')\n"
                printf "  æ¶æ„: $(uname -m 2>/dev/null || echo 'N/A')\n"
                printf "  SKRoot: $($SU -v 2>/dev/null || echo 'N/A')\n"
                printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                pause
                ;;
            0) return ;;
        esac
    done
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 è®¾ç½®
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

settings_menu() {
    while true; do
        banner
        draw_box "è®¾ç½®"
        
        if [ $STEALTH_ON -eq 1 ]; then
            menu_item "1" "åæ£€æµ‹æ¨¡å¼" "${G}â— å¼€å¯${N}"
        else
            menu_item "1" "åæ£€æµ‹æ¨¡å¼" "${R}â—‹ å…³é—­${N}"
        fi
        
        menu_item "2" "æŸ¥çœ‹å½“å‰é…ç½®" ""
        menu_item "3" "æ¸…é™¤å†å²è®°å½•" ""
        menu_item "4" "æ¸…é™¤æ—¥å¿—" ""
        menu_separator
        menu_item "5" "å…³äº StealthMem" ""
        menu_item "6" "ä½¿ç”¨å¸®åŠ©" ""
        menu_empty
        menu_item "0" "è¿”å›ä¸»èœå•" ""
        draw_box_end
        
        printf "\n  ${W}é€‰æ‹© > ${N}"
        read choice
        
        case "$choice" in
            1)
                if [ $STEALTH_ON -eq 1 ]; then
                    STEALTH_ON=0
                    STEALTH_MODE="--no-stealth"
                    p_warn "åæ£€æµ‹å·²å…³é—­"
                else
                    STEALTH_ON=1
                    STEALTH_MODE="--stealth"
                    p_ok "åæ£€æµ‹å·²å¼€å¯"
                fi
                log "åæ£€æµ‹: $STEALTH_ON"
                sleep 1
                ;;
            2)
                printf "\n"
                printf "  ${W}å½“å‰é…ç½®:${N}\n"
                printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                printf "  ROOT_KEY:   ${D}%s...${N}\n" "${ROOT_KEY:0:20}"
                printf "  TOOL:       %s\n" "$TOOL"
                printf "  SU:         %s\n" "$SU"
                printf "  PATCH_DIR:  %s\n" "$PATCH_DIR"
                printf "  GAME:       %s (%s)\n" "$GAME_NAME" "$GAME_PKG"
                printf "  STEALTH:    %s\n" "$STEALTH_MODE"
                printf "  ${D}â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€${N}\n"
                pause
                ;;
            3)
                rm -f "$HISTORY_FILE"
                touch "$HISTORY_FILE"
                p_ok "å†å²è®°å½•å·²æ¸…é™¤"
                sleep 1
                ;;
            4)
                rm -f "$LOG_FILE"
                p_ok "æ—¥å¿—å·²æ¸…é™¤"
                sleep 1
                ;;
            5) show_about ;;
            6) show_help ;;
            0) return ;;
        esac
    done
}

show_about() {
    cls
    printf "\n"
    printf "${P}"
    cat << 'ABOUT'
   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
   â•‘                                                               â•‘
   â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—     â•‘
   â•‘   â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘     â•‘
   â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘     â•‘
   â•‘   â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘     â•‘
   â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘     â•‘
   â•‘   â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•   â•šâ•â•  â•šâ•â•     â•‘
   â•‘                                                               â•‘
   â•‘                    M E M O R Y   T O O L                      â•‘
   â•‘                                                               â•‘
   â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
ABOUT
    printf "${N}"
    printf "${C}   â•‘${N}  ç‰ˆæœ¬: ${Y}v$VERSION${N} Pro Edition                                  ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}  æ„å»º: $BUILD_DATE                                              ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}                                                               ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}  ${W}æ ¸å¿ƒç‰¹æ€§:${N}                                                   ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}    ${G}âœ“${N} åŸºäº /proc/pid/mem å†…æ ¸çº§å†…å­˜è®¿é—®                      ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}    ${G}âœ“${N} ä¸ä¿®æ”¹æ–‡ä»¶ (ç»•è¿‡å®Œæ•´æ€§æ£€æµ‹)                            ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}    ${G}âœ“${N} ä¸ä½¿ç”¨ ptrace (ç»•è¿‡åè°ƒè¯•)                             ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}    ${G}âœ“${N} è¿›ç¨‹åä¼ªè£… (kworker/0:0)                               ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}    ${G}âœ“${N} æ—¶åºéšæœºåŒ– + åˆ†å—è®¿é—®                                  ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}                                                               ${C}â•‘${N}\n"
    printf "${C}   â•‘${N}  ${W}ä¾èµ–:${N} SKRoot Lite å†…æ ¸                                     ${C}â•‘${N}\n"
    printf "${C}   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${N}\n"
    pause
}

show_help() {
    cls
    printf "\n"
    draw_box "ä½¿ç”¨å¸®åŠ©"
    printf "${C}â•‘${N}                                                            ${C}â•‘${N}\n"
    printf "${C}â•‘${N}  ${W}åŸºæœ¬æµç¨‹:${N}                                                 ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    1. å¯åŠ¨ç›®æ ‡æ¸¸æˆ                                          ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    2. é€‰æ‹©æ¸¸æˆ (ä¸»èœå• -> é€‰æ‹©æ¸¸æˆ)                          ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    3. è¿›è¡Œå†…å­˜æ“ä½œ                                          ${C}â•‘${N}\n"
    printf "${C}â•‘${N}                                                            ${C}â•‘${N}\n"
    printf "${C}â•‘${N}  ${W}å†…å­˜æ“ä½œ:${N}                                                 ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - è¯»å–: æŸ¥çœ‹æŒ‡å®šåœ°å€çš„å†…å­˜å†…å®¹                           ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - å†™å…¥: ä¿®æ”¹æŒ‡å®šåœ°å€çš„å†…å­˜å€¼                             ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - æ˜ å°„: æŸ¥çœ‹è¿›ç¨‹çš„å†…å­˜å¸ƒå±€                               ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - æ¨¡å—: æŸ¥æ‰¾SOåº“çš„åŠ è½½åœ°å€                               ${C}â•‘${N}\n"
    printf "${C}â•‘${N}                                                            ${C}â•‘${N}\n"
    printf "${C}â•‘${N}  ${W}Patch åŠŸèƒ½:${N}                                               ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - åˆ›å»º .patch é…ç½®æ–‡ä»¶å®šä¹‰ä¿®æ”¹è§„åˆ™                       ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - åº”ç”¨: ä¸€æ¬¡æ€§æ‰§è¡Œæ‰€æœ‰ä¿®æ”¹                               ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - ç›‘æ§: æŒç»­æ£€æµ‹å¹¶è‡ªåŠ¨é‡æ–°åº”ç”¨                           ${C}â•‘${N}\n"
    printf "${C}â•‘${N}                                                            ${C}â•‘${N}\n"
    printf "${C}â•‘${N}  ${W}åæ£€æµ‹è¯´æ˜:${N}                                               ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    å¼€å¯åä¼šå¯ç”¨ä»¥ä¸‹ä¿æŠ¤:                                    ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - è¿›ç¨‹åä¼ªè£…ä¸º kworker/0:0                               ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - éšæœºå»¶è¿Ÿ (100-5000Î¼s)                                  ${C}â•‘${N}\n"
    printf "${C}â•‘${N}    - åˆ†å—è¯»å†™ (64å­—èŠ‚/å—)                                   ${C}â•‘${N}\n"
    printf "${C}â•‘${N}                                                            ${C}â•‘${N}\n"
    draw_box_end
    pause
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 ä¸»èœå•
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

main_menu() {
    while true; do
        banner
        draw_box "ä¸»èœå•"
        menu_item "1" "é€‰æ‹©æ¸¸æˆ" "$GAME_NAME"
        menu_item "2" "å†…å­˜æ“ä½œ" "è¯»/å†™/æ˜ å°„"
        menu_item "3" "Patch æ“ä½œ" "æ‰¹é‡/ç›‘æ§"
        menu_item "4" "å¿«æ·åŠŸèƒ½" "åˆ†æ/å¯¼å‡º"
        menu_item "5" "è®¾ç½®" ""
        menu_separator
        menu_item "q" "é€€å‡ºç¨‹åº" ""
        draw_box_end
        
        printf "\n  ${W}é€‰æ‹© > ${N}"
        read choice
        
        case "$choice" in
            1) select_game ;;
            2) mem_menu ;;
            3) patch_menu ;;
            4) quick_menu ;;
            5) settings_menu ;;
            q|Q|0)
                cls
                printf "\n"
                printf "${P}"
                cat << 'BYE'
   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
   â•‘                                                               â•‘
   â•‘                      å†è§å®å®~ ğŸ’•                             â•‘
   â•‘                                                               â•‘
   â•‘                  StealthMem Pro v5.0                          â•‘
   â•‘                                                               â•‘
   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
BYE
                printf "${N}\n"
                log "=== é€€å‡º ==="
                exit 0
                ;;
        esac
    done
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                                 å…¥å£
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
init
main_menu
